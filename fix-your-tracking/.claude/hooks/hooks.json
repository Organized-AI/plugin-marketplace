{
  "hooks": [
    {
      "name": "pre-phase",
      "description": "Validates prerequisites before each GTM deployment phase",
      "event": "before_command",
      "command_pattern": "gtm-deploy",
      "action": {
        "type": "prompt",
        "content": "Before executing this phase, validate: 1) CONFIG/config.json exists with GTM credentials, 2) MCP server is authenticated, 3) Previous phase artifacts are available in phase-state.json"
      }
    },
    {
      "name": "post-phase",
      "description": "Confirms completion and updates state after each phase",
      "event": "after_command",
      "command_pattern": "gtm-deploy",
      "action": {
        "type": "prompt",
        "content": "After phase completion: 1) Update CONFIG/phase-state.json with artifacts, 2) Create PHASE-X-COMPLETE.md, 3) Verify no workspace conflicts before proceeding"
      }
    },
    {
      "name": "pre-publish-audit",
      "description": "Mandatory container audit before publishing",
      "event": "before_command",
      "command_pattern": "gtm_version.*publish",
      "action": {
        "type": "prompt",
        "content": "MANDATORY: Run full container audit before publishing. Check for: workspace conflicts, broken references, duplicate tags, naming violations. Block if critical issues found."
      }
    },
    {
      "name": "ascii-diagram-generator",
      "description": "Generates visual documentation for GTM changes",
      "event": "after_command",
      "command_pattern": "gtm-audit|tidy-gtm",
      "action": {
        "type": "prompt",
        "content": "Generate ASCII diagram showing: 1) Before/after container state, 2) Data flow from user to platforms, 3) Web â†” Server correlation matrix if applicable"
      }
    },
    {
      "name": "meta-ads-auth-check",
      "description": "Validates Meta Ads authentication before API calls",
      "event": "before_tool",
      "tool_pattern": "meta-ads-mcp:*",
      "action": {
        "type": "validate",
        "content": "Verify PIPEBOARD_API_TOKEN or META_APP_ID is configured. If not authenticated, prompt user to run meta-ads login flow."
      }
    },
    {
      "name": "google-ads-auth-check",
      "description": "Validates Google Ads authentication before API calls",
      "event": "before_tool",
      "tool_pattern": "google-ads-mcp:*",
      "action": {
        "type": "validate",
        "content": "Verify GOOGLE_ADS_CREDENTIALS_PATH and GOOGLE_ADS_DEVELOPER_TOKEN are configured. Check for valid OAuth token or service account."
      }
    },
    {
      "name": "cross-platform-sync-validation",
      "description": "Validates data consistency before cross-platform sync",
      "event": "before_command",
      "command_pattern": "sync-data",
      "action": {
        "type": "prompt",
        "content": "Before syncing: 1) Validate GHL API connectivity, 2) Check TripleWhale API status, 3) Verify date range and contact filters, 4) Confirm no duplicate records will be created"
      }
    },
    {
      "name": "audit-summary-generator",
      "description": "Generates comprehensive audit summary after full audit",
      "event": "after_command",
      "command_pattern": "full-audit",
      "action": {
        "type": "prompt",
        "content": "Generate comprehensive audit summary: 1) Executive summary with critical issues, 2) Platform-by-platform breakdown, 3) Prioritized action items, 4) Estimated impact of fixes"
      }
    }
  ],
  "settings": {
    "phases": {
      "enforceSequence": true,
      "allowSkip": false,
      "blockOnCriticalIssues": true,
      "autoAuditBeforePublish": true,
      "autoGenerateDiagrams": true
    },
    "triggers": {
      "prePublishAudit": [
        "phase_4_start",
        "before_publish",
        "component_changes_gt_5"
      ],
      "asciiDiagramGeneration": [
        "post_phase_2",
        "post_tidy_gtm_audit",
        "sgtm_correlation_check"
      ],
      "authValidation": [
        "before_api_call",
        "token_expired",
        "first_tool_use"
      ]
    },
    "notifications": {
      "criticalIssues": true,
      "phaseCompletion": true,
      "authExpiration": true
    }
  }
}
